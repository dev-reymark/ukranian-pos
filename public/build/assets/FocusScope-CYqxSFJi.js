import{b as I}from"./useFocusable-C3L5tljt.js";import{h as P,a as w,i as E}from"./chunk-XHQUSKIE-C55Rkeru.js";import{r as h,e as y}from"./app-DrQA5isL.js";function Z(e,t){let r=window.getComputedStyle(e),n=/(auto|scroll)/.test(r.overflow+r.overflowX+r.overflowY);return n&&t&&(n=e.scrollHeight!==e.clientHeight||e.scrollWidth!==e.clientWidth),n}function V(e){const t=P(e);if(!(e instanceof t.HTMLElement)&&!(e instanceof t.SVGElement))return!1;let{display:r,visibility:n}=e.style,o=r!=="none"&&n!=="hidden"&&n!=="collapse";if(o){const{getComputedStyle:l}=e.ownerDocument.defaultView;let{display:c,visibility:a}=l(e);o=c!=="none"&&a!=="hidden"&&a!=="collapse"}return o}function B(e,t){return!e.hasAttribute("hidden")&&!e.hasAttribute("data-react-aria-prevent-focus")&&(e.nodeName==="DETAILS"&&t&&t.nodeName!=="SUMMARY"?e.hasAttribute("open"):!0)}function K(e,t){return e.nodeName!=="#comment"&&V(e)&&B(e,t)&&(!e.parentElement||K(e.parentElement,e))}const A=y.createContext(null);let f=null;function O(e){let{children:t,contain:r,restoreFocus:n,autoFocus:o}=e,l=h.useRef(null),c=h.useRef(null),a=h.useRef([]),{parentNode:s}=h.useContext(A)||{},i=h.useMemo(()=>new _({scopeRef:a}),[a]);w(()=>{let v=s||p.root;if(p.getTreeNode(v.scopeRef)&&f&&!L(f,v.scopeRef)){let b=p.getTreeNode(f);b&&(v=b)}v.addChild(i),p.addNode(i)},[i,s]),w(()=>{let v=p.getTreeNode(a);v&&(v.contain=!!r)},[r]),w(()=>{var v;let b=(v=l.current)===null||v===void 0?void 0:v.nextSibling,N=[];for(;b&&b!==c.current;)N.push(b),b=b.nextSibling;a.current=N},[t]),U(a,n,r),W(a,r),G(a,n,r),q(a,o),h.useEffect(()=>{const v=E(a.current?a.current[0]:void 0).activeElement;let b=null;if($(v,a.current)){for(let N of p.traverse())N.scopeRef&&$(v,N.scopeRef.current)&&(b=N);b===p.getTreeNode(a)&&(f=b.scopeRef)}},[a]),w(()=>()=>{var v,b,N;let F=(N=(b=p.getTreeNode(a))===null||b===void 0||(v=b.parent)===null||v===void 0?void 0:v.scopeRef)!==null&&N!==void 0?N:null;(a===f||L(a,f))&&(!F||p.getTreeNode(F))&&(f=F),p.removeTreeNode(a)},[a]);let u=h.useMemo(()=>j(a),[]),d=h.useMemo(()=>({focusManager:u,parentNode:i}),[i,u]);return y.createElement(A.Provider,{value:d},y.createElement("span",{"data-focus-scope-start":!0,hidden:!0,ref:l}),t,y.createElement("span",{"data-focus-scope-end":!0,hidden:!0,ref:c}))}function j(e){return{focusNext(t={}){let r=e.current,{from:n,tabbable:o,wrap:l,accept:c}=t,a=n||E(r[0]).activeElement,s=r[0].previousElementSibling,i=g(r),u=T(i,{tabbable:o,accept:c},r);u.currentNode=$(a,r)?a:s;let d=u.nextNode();return!d&&l&&(u.currentNode=s,d=u.nextNode()),d&&m(d,!0),d},focusPrevious(t={}){let r=e.current,{from:n,tabbable:o,wrap:l,accept:c}=t,a=n||E(r[0]).activeElement,s=r[r.length-1].nextElementSibling,i=g(r),u=T(i,{tabbable:o,accept:c},r);u.currentNode=$(a,r)?a:s;let d=u.previousNode();return!d&&l&&(u.currentNode=s,d=u.previousNode()),d&&m(d,!0),d},focusFirst(t={}){let r=e.current,{tabbable:n,accept:o}=t,l=g(r),c=T(l,{tabbable:n,accept:o},r);c.currentNode=r[0].previousElementSibling;let a=c.nextNode();return a&&m(a,!0),a},focusLast(t={}){let r=e.current,{tabbable:n,accept:o}=t,l=g(r),c=T(l,{tabbable:n,accept:o},r);c.currentNode=r[r.length-1].nextElementSibling;let a=c.previousNode();return a&&m(a,!0),a}}}const M=["input:not([disabled]):not([type=hidden])","select:not([disabled])","textarea:not([disabled])","button:not([disabled])","a[href]","area[href]","summary","iframe","object","embed","audio[controls]","video[controls]","[contenteditable]"],z=M.join(":not([hidden]),")+",[tabindex]:not([disabled]):not([hidden])";M.push('[tabindex]:not([tabindex="-1"]):not([disabled])');const H=M.join(':not([hidden]):not([tabindex="-1"]),');function g(e){return e[0].parentElement}function x(e){let t=p.getTreeNode(f);for(;t&&t.scopeRef!==e;){if(t.contain)return!1;t=t.parent}return!0}function W(e,t){let r=h.useRef(),n=h.useRef();w(()=>{let o=e.current;if(!t){n.current&&(cancelAnimationFrame(n.current),n.current=void 0);return}const l=E(o?o[0]:void 0);let c=i=>{if(i.key!=="Tab"||i.altKey||i.ctrlKey||i.metaKey||!x(e)||i.isComposing)return;let u=l.activeElement,d=e.current;if(!d||!$(u,d))return;let v=g(d),b=T(v,{tabbable:!0},d);if(!u)return;b.currentNode=u;let N=i.shiftKey?b.previousNode():b.nextNode();N||(b.currentNode=i.shiftKey?d[d.length-1].nextElementSibling:d[0].previousElementSibling,N=i.shiftKey?b.previousNode():b.nextNode()),i.preventDefault(),N&&m(N,!0)},a=i=>{(!f||L(f,e))&&$(i.target,e.current)?(f=e,r.current=i.target):x(e)&&!S(i.target,e)?r.current?r.current.focus():f&&f.current&&R(f.current):x(e)&&(r.current=i.target)},s=i=>{n.current&&cancelAnimationFrame(n.current),n.current=requestAnimationFrame(()=>{if(l.activeElement&&x(e)&&!S(l.activeElement,e))if(f=e,l.body.contains(i.target)){var u;r.current=i.target,(u=r.current)===null||u===void 0||u.focus()}else f.current&&R(f.current)})};return l.addEventListener("keydown",c,!1),l.addEventListener("focusin",a,!1),o==null||o.forEach(i=>i.addEventListener("focusin",a,!1)),o==null||o.forEach(i=>i.addEventListener("focusout",s,!1)),()=>{l.removeEventListener("keydown",c,!1),l.removeEventListener("focusin",a,!1),o==null||o.forEach(i=>i.removeEventListener("focusin",a,!1)),o==null||o.forEach(i=>i.removeEventListener("focusout",s,!1))}},[e,t]),w(()=>()=>{n.current&&cancelAnimationFrame(n.current)},[n])}function D(e){return S(e)}function $(e,t){return!e||!t?!1:t.some(r=>r.contains(e))}function S(e,t=null){if(e instanceof Element&&e.closest("[data-react-aria-top-layer]"))return!0;for(let{scopeRef:r}of p.traverse(p.getTreeNode(t)))if(r&&$(e,r.current))return!0;return!1}function ee(e){return S(e,f)}function L(e,t){var r;let n=(r=p.getTreeNode(t))===null||r===void 0?void 0:r.parent;for(;n;){if(n.scopeRef===e)return!0;n=n.parent}return!1}function m(e,t=!1){if(e!=null&&!t)try{I(e)}catch{}else if(e!=null)try{e.focus()}catch{}}function R(e,t=!0){let r=e[0].previousElementSibling,n=g(e),o=T(n,{tabbable:t},e);o.currentNode=r;let l=o.nextNode();t&&!l&&(n=g(e),o=T(n,{tabbable:!1},e),o.currentNode=r,l=o.nextNode()),m(l)}function q(e,t){const r=y.useRef(t);h.useEffect(()=>{if(r.current){f=e;const n=E(e.current?e.current[0]:void 0);!$(n.activeElement,f.current)&&e.current&&R(e.current)}r.current=!1},[e])}function U(e,t,r){w(()=>{if(t||r)return;let n=e.current;const o=E(n?n[0]:void 0);let l=c=>{let a=c.target;$(a,e.current)?f=e:D(a)||(f=null)};return o.addEventListener("focusin",l,!1),n==null||n.forEach(c=>c.addEventListener("focusin",l,!1)),()=>{o.removeEventListener("focusin",l,!1),n==null||n.forEach(c=>c.removeEventListener("focusin",l,!1))}},[e,t,r])}function Y(e){let t=p.getTreeNode(f);for(;t&&t.scopeRef!==e;){if(t.nodeToRestore)return!1;t=t.parent}return(t==null?void 0:t.scopeRef)===e}function G(e,t,r){const n=h.useRef(typeof document<"u"?E(e.current?e.current[0]:void 0).activeElement:null);w(()=>{let o=e.current;const l=E(o?o[0]:void 0);if(!t||r)return;let c=()=>{(!f||L(f,e))&&$(l.activeElement,e.current)&&(f=e)};return l.addEventListener("focusin",c,!1),o==null||o.forEach(a=>a.addEventListener("focusin",c,!1)),()=>{l.removeEventListener("focusin",c,!1),o==null||o.forEach(a=>a.removeEventListener("focusin",c,!1))}},[e,r]),w(()=>{const o=E(e.current?e.current[0]:void 0);if(!t)return;let l=c=>{if(c.key!=="Tab"||c.altKey||c.ctrlKey||c.metaKey||!x(e)||c.isComposing)return;let a=o.activeElement;if(!$(a,e.current))return;let s=p.getTreeNode(e);if(!s)return;let i=s.nodeToRestore,u=T(o.body,{tabbable:!0});u.currentNode=a;let d=c.shiftKey?u.previousNode():u.nextNode();if((!i||!o.body.contains(i)||i===o.body)&&(i=void 0,s.nodeToRestore=void 0),(!d||!$(d,e.current))&&i){u.currentNode=i;do d=c.shiftKey?u.previousNode():u.nextNode();while($(d,e.current));c.preventDefault(),c.stopPropagation(),d?m(d,!0):D(i)?m(i,!0):a.blur()}};return r||o.addEventListener("keydown",l,!0),()=>{r||o.removeEventListener("keydown",l,!0)}},[e,t,r]),w(()=>{const o=E(e.current?e.current[0]:void 0);if(!t)return;let l=p.getTreeNode(e);if(l){var c;return l.nodeToRestore=(c=n.current)!==null&&c!==void 0?c:void 0,()=>{let a=p.getTreeNode(e);if(!a)return;let s=a.nodeToRestore;if(t&&s&&($(o.activeElement,e.current)||o.activeElement===o.body&&Y(e))){let i=p.clone();requestAnimationFrame(()=>{if(o.activeElement===o.body){let u=i.getTreeNode(e);for(;u;){if(u.nodeToRestore&&u.nodeToRestore.isConnected){m(u.nodeToRestore);return}u=u.parent}for(u=i.getTreeNode(e);u;){if(u.scopeRef&&u.scopeRef.current&&p.getTreeNode(u.scopeRef)){R(u.scopeRef.current,!0);return}u=u.parent}}})}}}},[e,t])}function T(e,t,r){let n=t!=null&&t.tabbable?H:z,o=E(e).createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode(l){var c;return!(t==null||(c=t.from)===null||c===void 0)&&c.contains(l)?NodeFilter.FILTER_REJECT:l.matches(n)&&K(l)&&(!r||$(l,r))&&(!(t!=null&&t.accept)||t.accept(l))?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});return t!=null&&t.from&&(o.currentNode=t.from),o}function te(e,t={}){return{focusNext(r={}){let n=e.current;if(!n)return null;let{from:o,tabbable:l=t.tabbable,wrap:c=t.wrap,accept:a=t.accept}=r,s=o||E(n).activeElement,i=T(n,{tabbable:l,accept:a});n.contains(s)&&(i.currentNode=s);let u=i.nextNode();return!u&&c&&(i.currentNode=n,u=i.nextNode()),u&&m(u,!0),u},focusPrevious(r=t){let n=e.current;if(!n)return null;let{from:o,tabbable:l=t.tabbable,wrap:c=t.wrap,accept:a=t.accept}=r,s=o||E(n).activeElement,i=T(n,{tabbable:l,accept:a});if(n.contains(s))i.currentNode=s;else{let d=C(i);return d&&m(d,!0),d??null}let u=i.previousNode();if(!u&&c){i.currentNode=n;let d=C(i);if(!d)return null;u=d}return u&&m(u,!0),u??null},focusFirst(r=t){let n=e.current;if(!n)return null;let{tabbable:o=t.tabbable,accept:l=t.accept}=r,a=T(n,{tabbable:o,accept:l}).nextNode();return a&&m(a,!0),a},focusLast(r=t){let n=e.current;if(!n)return null;let{tabbable:o=t.tabbable,accept:l=t.accept}=r,c=T(n,{tabbable:o,accept:l}),a=C(c);return a&&m(a,!0),a??null}}}function C(e){let t,r;do r=e.lastChild(),r&&(t=r);while(r);return t}class k{get size(){return this.fastMap.size}getTreeNode(t){return this.fastMap.get(t)}addTreeNode(t,r,n){let o=this.fastMap.get(r??null);if(!o)return;let l=new _({scopeRef:t});o.addChild(l),l.parent=o,this.fastMap.set(t,l),n&&(l.nodeToRestore=n)}addNode(t){this.fastMap.set(t.scopeRef,t)}removeTreeNode(t){if(t===null)return;let r=this.fastMap.get(t);if(!r)return;let n=r.parent;for(let l of this.traverse())l!==r&&r.nodeToRestore&&l.nodeToRestore&&r.scopeRef&&r.scopeRef.current&&$(l.nodeToRestore,r.scopeRef.current)&&(l.nodeToRestore=r.nodeToRestore);let o=r.children;n&&(n.removeChild(r),o.size>0&&o.forEach(l=>n&&n.addChild(l))),this.fastMap.delete(r.scopeRef)}*traverse(t=this.root){if(t.scopeRef!=null&&(yield t),t.children.size>0)for(let r of t.children)yield*this.traverse(r)}clone(){var t;let r=new k;var n;for(let o of this.traverse())r.addTreeNode(o.scopeRef,(n=(t=o.parent)===null||t===void 0?void 0:t.scopeRef)!==null&&n!==void 0?n:null,o.nodeToRestore);return r}constructor(){this.fastMap=new Map,this.root=new _({scopeRef:null}),this.fastMap.set(null,this.root)}}class _{addChild(t){this.children.add(t),t.parent=this}removeChild(t){this.children.delete(t),t.parent=void 0}constructor(t){this.children=new Set,this.contain=!1,this.scopeRef=t.scopeRef}}let p=new k;export{T as $,Z as a,ee as b,O as c,te as d};
