import{r as t,u as de,j as e,a as L}from"./app-BgclCP_U.js";import{I as ce,_ as T}from"./index-BB6kETrK.js";import{d as ue,$ as z,a as fe}from"./chunk-RUXXUVWM-DVz6Pog_.js";import{c as me,b as Q,d as pe}from"./chunk-XHQUSKIE-C9evg4Jy.js";import{$ as xe,c as be,C as ve,a as he}from"./chunk-KBN3H6OQ-DOSo4uLf.js";import{b as ge}from"./useFocusable-CtZfeggp.js";import{$ as Pe,i as Y}from"./chunk-GQQM5TNQ-CwUyVOv_.js";import{$ as Ie,b as je}from"./useFormValidationState-Ct6XxOLM.js";import{$ as $e}from"./useControlledState-DEEM-shP.js";import{u as Ne}from"./chunk-RQNQ5XFG-CmL0HLIT.js";import{f as Ce}from"./chunk-RJKRL3AU-CjtrMR1U.js";import{s as _e}from"./chunk-CAFRINWI-BTDo8zfp.js";import{c as G,f as Me}from"./chunk-N2KXC5ZE-OZCedwgk.js";import{m as ye,a as De,b as Se,c as Ge,d as Re}from"./chunk-P2T5LMDM-reKcKOSN.js";import{c as U}from"./chunk-H4VOEXHF-TewfOLb0.js";import{c as H}from"./chunk-J333S7JQ-fhG3Ko0V.js";import{d as R}from"./chunk-44JHHBS2-C3-jQeuQ.js";import{c as K}from"./chunk-5ALFRFZW-DZJt4FN_.js";import{b as J}from"./chunk-DBLREEYE-CG8yp442.js";import"./getScrollParent-ClU_Bz4K.js";import"./FocusScope-DU-SyPrP.js";import"./scrollIntoView-SfQOsQd-.js";import"./useFormReset-DYDVEd1s.js";import"./useLabels-Cb_neJ1j.js";import"./useCollator-BBcv62qp.js";import"./LiveAnnouncer-D-UZuySi.js";import"./index-D3TozaOH.js";import"./chunk-2PIR7DFM-CbcDDgM_.js";import"./chunk-6NL67ZRH-DYxa27IY.js";import"./index-X92CTFGl.js";import"./VisuallyHidden-DfowBU03.js";import"./useToggleState-DB5UMKni.js";import"./index-DpSBb8zT.js";import"./useLabel-DpShN-Pb.js";import"./chunk-M3MASYO7-Bt50UMbM.js";function ke(a,l){let{isDisabled:o,name:b,validationBehavior:d="aria"}=a,{isInvalid:p,validationErrors:s,validationDetails:v}=l.displayValidation,{labelProps:x,fieldProps:i,descriptionProps:n,errorMessageProps:c}=Pe({...a,labelElementType:"span",isInvalid:p,errorMessage:a.errorMessage||s});xe.set(l,{name:b,descriptionId:n.id,errorMessageId:c.id,validationBehavior:d});let I=ge(a,{labelable:!0}),{focusWithinProps:g}=me({onBlurWithin:a.onBlur,onFocusWithin:a.onFocus,onFocusWithinChange:a.onFocusChange});return{groupProps:Q(I,{role:"group","aria-disabled":o||void 0,...i,...g}),labelProps:x,descriptionProps:n,errorMessageProps:c,isInvalid:p,validationErrors:s,validationDetails:v}}function Ee(a={}){let[l,o]=$e(a.value,a.defaultValue||[],a.onChange),b=!!a.isRequired&&l.length===0,d=t.useRef(new Map),p=Ie({...a,value:l}),s=p.displayValidation.isInvalid;var v;return{...p,value:l,setValue(i){a.isReadOnly||a.isDisabled||o(i)},isDisabled:a.isDisabled||!1,isReadOnly:a.isReadOnly||!1,isSelected(i){return l.includes(i)},addValue(i){a.isReadOnly||a.isDisabled||l.includes(i)||o(l.concat(i))},removeValue(i){a.isReadOnly||a.isDisabled||l.includes(i)&&o(l.filter(n=>n!==i))},toggleValue(i){a.isReadOnly||a.isDisabled||(l.includes(i)?o(l.filter(n=>n!==i)):o(l.concat(i)))},setInvalid(i,n){let c=new Map(d.current);n.isInvalid?c.set(i,n):c.delete(i),d.current=c,p.updateValidation(je(...c.values()))},validationState:(v=a.validationState)!==null&&v!==void 0?v:s?"invalid":null,isInvalid:s,isRequired:b}}function Fe(a){var l,o;const b=de(),{as:d,ref:p,classNames:s,children:v,label:x,radius:i,value:n,name:c,defaultValue:I,isInvalid:g,validationState:C,size:_="md",color:M="primary",orientation:u="vertical",lineThrough:m=!1,isDisabled:f=!1,validationBehavior:r=(l=b==null?void 0:b.validationBehavior)!=null?l:"aria",disableAnimation:j=(o=b==null?void 0:b.disableAnimation)!=null?o:!1,isReadOnly:k,isRequired:y,onValueChange:E,description:Z,errorMessage:D,className:ee,...N}=a,F=d||"div",ae=typeof F=="string",V=Ne(p),w=t.useMemo(()=>({...N,value:n,name:c,"aria-label":_e(N["aria-label"],x),defaultValue:I,isRequired:y,isReadOnly:k,orientation:u,validationBehavior:r,isInvalid:C==="invalid"||g,onChange:pe(a.onChange,E)}),[n,c,x,I,y,k,u,E,g,C,r,N["aria-label"],N]),h=Ee(w),{labelProps:O,groupProps:B,descriptionProps:W,errorMessageProps:q,validationErrors:S,validationDetails:se}=ke(w,h),ie=t.useMemo(()=>({size:_,color:M,radius:i,lineThrough:m,isInvalid:h.isInvalid,isDisabled:f,disableAnimation:j,validationBehavior:r,groupState:h}),[_,M,i,m,f,j,r,h.value,h.isDisabled,h.isReadOnly,h.isInvalid,h.isSelected]),P=t.useMemo(()=>be({isRequired:y,isInvalid:h.isInvalid,disableAnimation:j}),[y,h.isInvalid,,j]),A=G(s==null?void 0:s.base,ee),re=t.useCallback(()=>({ref:V,className:P.base({class:A}),...Q(B,Ce(N,{enabled:ae}))}),[P,V,A,B,N]),le=t.useCallback(()=>({className:P.label({class:s==null?void 0:s.label}),...O}),[P,O,s==null?void 0:s.label]),te=t.useCallback(()=>({className:P.wrapper({class:s==null?void 0:s.wrapper}),role:"presentation","data-orientation":u}),[P,u,s==null?void 0:s.wrapper]),oe=t.useCallback(($={})=>({...$,...W,className:P.description({class:G(s==null?void 0:s.description,$==null?void 0:$.className)})}),[P,W,s==null?void 0:s.description]),ne=t.useCallback(($={})=>({...$,...q,className:P.errorMessage({class:G(s==null?void 0:s.errorMessage,$==null?void 0:$.className)})}),[P,q,s==null?void 0:s.errorMessage]);return{Component:F,children:v,label:x,context:ie,description:Z,isInvalid:h.isInvalid,errorMessage:typeof D=="function"?D({isInvalid:h.isInvalid,validationErrors:S,validationDetails:se}):D||(S==null?void 0:S.join(" ")),getGroupProps:re,getLabelProps:le,getWrapperProps:te,getDescriptionProps:oe,getErrorMessageProps:ne}}var X=Me((a,l)=>{const{children:o,context:b,label:d,description:p,isInvalid:s,errorMessage:v,getGroupProps:x,getLabelProps:i,getWrapperProps:n,getDescriptionProps:c,getErrorMessageProps:I}=Fe({...a,ref:l}),g=t.useMemo(()=>v,[s]);return e.jsxs("div",{...x(),children:[d&&e.jsx("span",{...i(),children:d}),e.jsx("div",{...n(),children:e.jsx(ve,{value:b,children:o})}),s&&g?e.jsx("div",{...I(),children:g}):p?e.jsx("div",{...c(),children:p}):null]})});X.displayName="NextUI.CheckboxGroup";var Ve=X;function ha({isOpen:a,onOpenChange:l}){const[o,b]=t.useState([]),[d,p]=t.useState([]),[s,v]=t.useState({}),[x,i]=t.useState({}),[n,c]=t.useState(!1),[I,g]=t.useState(!1);t.useEffect(()=>{a&&L.get("/get-pump-nozzle").then(u=>{const m=u.data;b(m.FuelGrades||[]);const f={};m.FuelGrades.forEach(r=>{f[r.Id]=r.Price.toString()}),v(f)}).catch(u=>{console.error("Error fetching grades:",u)})},[a]);const C=u=>{p(u)},_=(u,m)=>{i(f=>({...f,[u]:m}))},M=()=>{if(d.length===0){console.error("No grades selected");return}if(d.some(r=>{const j=x[r];return!j||isNaN(parseFloat(j))})){g(!0);return}g(!1);const f={Protocol:"jsonPTS",Packets:[{Id:1,Type:"SetFuelGradesConfiguration",Data:{FuelGrades:o.map(r=>d.includes(r.Id.toString())?{...r,Price:parseFloat(x[r.Id]||s[r.Id])}:r)}}]};c(!0),L.post("/set-fuel-grades",f).then(()=>{T.success("Prices updated successfully!");const r={...s,...x};v(r),i({})}).catch(r=>{console.error("Error updating prices:",r),T.error("Failed to update prices")}).finally(()=>{c(!1),g(!1)})};return e.jsxs(e.Fragment,{children:[e.jsx(ce,{position:"top-center"}),e.jsx(ye,{isDismissable:!1,isKeyboardDismissDisabled:!0,size:"4xl",isOpen:a,onOpenChange:l,hideCloseButton:!0,children:e.jsx(De,{children:u=>e.jsxs(e.Fragment,{children:[e.jsx(Se,{className:"flex flex-col gap-1",children:e.jsx("h1",{className:"text-2xl font-extrabold",children:"PRICE CHANGE"})}),e.jsxs(Ge,{className:"w-full mx-auto p-3",children:[e.jsx(ue,{variant:"faded",defaultValue:z(fe()),label:e.jsx("p",{className:"text-lg font-extrabold",children:"EFFECTIVITY"}),labelPlacement:"outside-left",showMonthAndYearPickers:!0,minValue:z()}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs(U,{children:[e.jsx(H,{children:e.jsx("h2",{className:"text-xl font-extrabold",children:"Grades"})}),e.jsx(R,{}),e.jsx(K,{className:"p-4",children:e.jsx(Ve,{label:"Select Grades",onChange:C,children:o.map(m=>e.jsx(he,{className:"text-xl font-semibold",size:"lg",value:m.Id.toString(),children:m.Name.trim()},m.Id))})})]}),e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"flex-1 overflow-auto space-y-4 p-2",children:[e.jsx("div",{className:"grid grid-cols-3 gap-2",children:d.map(m=>{const f=o.find(r=>r.Id.toString()===m);return e.jsxs(U,{children:[e.jsx(H,{children:e.jsx("h2",{className:"text-xl font-extrabold",children:f.Name.trim()})}),e.jsx(R,{}),e.jsxs(K,{className:"gap-1 p-2",children:[e.jsx(Y,{label:"Current Price",value:s[f.Id],isReadOnly:!0}),e.jsx(Y,{label:"New Price",value:x[f.Id]||"",onChange:r=>_(f.Id,r.target.value),isRequired:!0,isInvalid:I,errorMessage:"Price not set"})]})]},f.Id)})}),d.length===0&&e.jsx("div",{className:"text-center",children:e.jsx("p",{className:"text-xl font-bold text-red-600",children:"No grades selected"})})]}),e.jsx(J,{color:"primary",fullWidth:!0,onClick:M,isLoading:n,className:"text-xl font-bold",children:"APPLY"})]})]})]}),e.jsx(R,{}),e.jsx(Re,{children:e.jsx(J,{color:"danger",onPress:u,children:"Close"})})]})})})]})}export{ha as default};
