import{e as de,v as ce,g as Q,r as t,u as ue,h as fe,B as pe,i as G,x as me,f as xe,j as e,d as L,c as T,a as z,b as Y}from"./app-DJ0OCxwK.js";import{I as ve,_ as U}from"./index-D834aa3t.js";import{d as be,$ as H,a as he}from"./chunk-RUXXUVWM-Dvg1qZRs.js";import{$ as ge,a as Pe,C as Ie,c as je}from"./chunk-KBN3H6OQ-CWXvv_JV.js";import{$ as $e,i as K}from"./chunk-GQQM5TNQ-P53s9ApC.js";import{$ as Ne,d as Ce}from"./useFormValidationState-cOo1klYh.js";import{$ as _e}from"./useControlledState-DF6__fTM.js";import{s as Me}from"./chunk-CAFRINWI-BTDo8zfp.js";import{m as ye,a as De,b as Se,c as Ge,d as Re}from"./chunk-P2T5LMDM-BSwoEP5i.js";import{d as R}from"./chunk-44JHHBS2-CWPKxyw1.js";import{b as J}from"./chunk-DBLREEYE-C6Vwu_wX.js";import"./getScrollParent-CTiUb1E9.js";import"./FocusScope-C3BCnoq3.js";import"./scrollIntoView-D_ErU28Z.js";import"./useFormReset-Dic5pjzl.js";import"./useLabels-C7uuHIf4.js";import"./NumberFormatter-DgUnyrzU.js";import"./useCollator-BqR0K-ta.js";import"./LiveAnnouncer-q_S9a73M.js";import"./chunk-2PIR7DFM-CbcDDgM_.js";import"./index-X92CTFGl.js";import"./VisuallyHidden-D0N98OxW.js";import"./useToggleState-BTeDqN7Y.js";import"./index-3GMhIGNj.js";import"./useLabel-BEN_EtuV.js";import"./chunk-M3MASYO7-CeYIKs2S.js";function ke(a,r){let{isDisabled:o,name:v,validationBehavior:d="aria"}=a,{isInvalid:m,validationErrors:s,validationDetails:b}=r.displayValidation,{labelProps:x,fieldProps:i,descriptionProps:n,errorMessageProps:c}=$e({...a,labelElementType:"span",isInvalid:m,errorMessage:a.errorMessage||s});ge.set(r,{name:v,descriptionId:n.id,errorMessageId:c.id,validationBehavior:d});let I=de(a,{labelable:!0}),{focusWithinProps:g}=ce({onBlurWithin:a.onBlur,onFocusWithin:a.onFocus,onFocusWithinChange:a.onFocusChange});return{groupProps:Q(I,{role:"group","aria-disabled":o||void 0,...i,...g}),labelProps:x,descriptionProps:n,errorMessageProps:c,isInvalid:m,validationErrors:s,validationDetails:b}}function Ee(a={}){let[r,o]=_e(a.value,a.defaultValue||[],a.onChange),v=!!a.isRequired&&r.length===0,d=t.useRef(new Map),m=Ne({...a,value:r}),s=m.displayValidation.isInvalid;var b;return{...m,value:r,setValue(i){a.isReadOnly||a.isDisabled||o(i)},isDisabled:a.isDisabled||!1,isReadOnly:a.isReadOnly||!1,isSelected(i){return r.includes(i)},addValue(i){a.isReadOnly||a.isDisabled||r.includes(i)||o(r.concat(i))},removeValue(i){a.isReadOnly||a.isDisabled||r.includes(i)&&o(r.filter(n=>n!==i))},toggleValue(i){a.isReadOnly||a.isDisabled||(r.includes(i)?o(r.filter(n=>n!==i)):o(r.concat(i)))},setInvalid(i,n){let c=new Map(d.current);n.isInvalid?c.set(i,n):c.delete(i),d.current=c,m.updateValidation(Ce(...c.values()))},validationState:(b=a.validationState)!==null&&b!==void 0?b:s?"invalid":null,isInvalid:s,isRequired:v}}function Fe(a){var r,o;const v=ue(),{as:d,ref:m,classNames:s,children:b,label:x,radius:i,value:n,name:c,defaultValue:I,isInvalid:g,validationState:C,size:_="md",color:M="primary",orientation:u="vertical",lineThrough:p=!1,isDisabled:f=!1,validationBehavior:l=(r=v==null?void 0:v.validationBehavior)!=null?r:"aria",disableAnimation:j=(o=v==null?void 0:v.disableAnimation)!=null?o:!1,isReadOnly:k,isRequired:y,onValueChange:E,description:Z,errorMessage:D,className:ee,...N}=a,F=d||"div",ae=typeof F=="string",V=fe(m),w=t.useMemo(()=>({...N,value:n,name:c,"aria-label":Me(N["aria-label"],x),defaultValue:I,isRequired:y,isReadOnly:k,orientation:u,validationBehavior:l,isInvalid:C==="invalid"||g,onChange:pe(a.onChange,E)}),[n,c,x,I,y,k,u,E,g,C,l,N["aria-label"],N]),h=Ee(w),{labelProps:O,groupProps:B,descriptionProps:W,errorMessageProps:q,validationErrors:S,validationDetails:se}=ke(w,h),ie=t.useMemo(()=>({size:_,color:M,radius:i,lineThrough:p,isInvalid:h.isInvalid,isDisabled:f,disableAnimation:j,validationBehavior:l,groupState:h}),[_,M,i,p,f,j,l,h.value,h.isDisabled,h.isReadOnly,h.isInvalid,h.isSelected]),P=t.useMemo(()=>Pe({isRequired:y,isInvalid:h.isInvalid,disableAnimation:j}),[y,h.isInvalid,,j]),A=G(s==null?void 0:s.base,ee),le=t.useCallback(()=>({ref:V,className:P.base({class:A}),...Q(B,me(N,{enabled:ae}))}),[P,V,A,B,N]),re=t.useCallback(()=>({className:P.label({class:s==null?void 0:s.label}),...O}),[P,O,s==null?void 0:s.label]),te=t.useCallback(()=>({className:P.wrapper({class:s==null?void 0:s.wrapper}),role:"presentation","data-orientation":u}),[P,u,s==null?void 0:s.wrapper]),oe=t.useCallback(($={})=>({...$,...W,className:P.description({class:G(s==null?void 0:s.description,$==null?void 0:$.className)})}),[P,W,s==null?void 0:s.description]),ne=t.useCallback(($={})=>({...$,...q,className:P.errorMessage({class:G(s==null?void 0:s.errorMessage,$==null?void 0:$.className)})}),[P,q,s==null?void 0:s.errorMessage]);return{Component:F,children:b,label:x,context:ie,description:Z,isInvalid:h.isInvalid,errorMessage:typeof D=="function"?D({isInvalid:h.isInvalid,validationErrors:S,validationDetails:se}):D||(S==null?void 0:S.join(" ")),getGroupProps:le,getLabelProps:re,getWrapperProps:te,getDescriptionProps:oe,getErrorMessageProps:ne}}var X=xe((a,r)=>{const{children:o,context:v,label:d,description:m,isInvalid:s,errorMessage:b,getGroupProps:x,getLabelProps:i,getWrapperProps:n,getDescriptionProps:c,getErrorMessageProps:I}=Fe({...a,ref:r}),g=t.useMemo(()=>b,[s]);return e.jsxs("div",{...x(),children:[d&&e.jsx("span",{...i(),children:d}),e.jsx("div",{...n(),children:e.jsx(Ie,{value:v,children:o})}),s&&g?e.jsx("div",{...I(),children:g}):m?e.jsx("div",{...c(),children:m}):null]})});X.displayName="NextUI.CheckboxGroup";var Ve=X;function da({isOpen:a,onOpenChange:r}){const[o,v]=t.useState([]),[d,m]=t.useState([]),[s,b]=t.useState({}),[x,i]=t.useState({}),[n,c]=t.useState(!1),[I,g]=t.useState(!1);t.useEffect(()=>{a&&L.get("/get-pump-nozzle").then(u=>{const p=u.data;v(p.FuelGrades||[]);const f={};p.FuelGrades.forEach(l=>{f[l.Id]=l.Price.toString()}),b(f)}).catch(u=>{console.error("Error fetching grades:",u)})},[a]);const C=u=>{m(u)},_=(u,p)=>{i(f=>({...f,[u]:p}))},M=()=>{if(d.length===0){console.error("No grades selected");return}if(d.some(l=>{const j=x[l];return!j||isNaN(parseFloat(j))})){g(!0);return}g(!1);const f={Protocol:"jsonPTS",Packets:[{Id:1,Type:"SetFuelGradesConfiguration",Data:{FuelGrades:o.map(l=>d.includes(l.Id.toString())?{...l,Price:parseFloat(x[l.Id]||s[l.Id])}:l)}}]};c(!0),L.post("/set-fuel-grades",f).then(()=>{U.success("Prices updated successfully!");const l={...s,...x};b(l),i({})}).catch(l=>{console.error("Error updating prices:",l),U.error("Failed to update prices")}).finally(()=>{c(!1),g(!1)})};return e.jsxs(e.Fragment,{children:[e.jsx(ve,{position:"top-center"}),e.jsx(ye,{isDismissable:!1,isKeyboardDismissDisabled:!0,size:"4xl",isOpen:a,onOpenChange:r,hideCloseButton:!0,children:e.jsx(De,{children:u=>e.jsxs(e.Fragment,{children:[e.jsx(Se,{className:"flex flex-col gap-1",children:e.jsx("h1",{className:"text-2xl font-extrabold",children:"PRICE CHANGE"})}),e.jsxs(Ge,{className:"w-full mx-auto p-3",children:[e.jsx(be,{variant:"faded",defaultValue:H(he()),label:e.jsx("p",{className:"text-lg font-extrabold",children:"EFFECTIVITY"}),labelPlacement:"outside-left",showMonthAndYearPickers:!0,minValue:H()}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs(T,{children:[e.jsx(z,{children:e.jsx("h2",{className:"text-xl font-extrabold",children:"Grades"})}),e.jsx(R,{}),e.jsx(Y,{className:"p-4",children:e.jsx(Ve,{label:"Select Grades",onChange:C,children:o.map(p=>e.jsx(je,{className:"text-xl font-semibold",size:"lg",value:p.Id.toString(),children:p.Name.trim()},p.Id))})})]}),e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"flex-1 overflow-auto space-y-4 p-2",children:[e.jsx("div",{className:"grid grid-cols-3 gap-2",children:d.map(p=>{const f=o.find(l=>l.Id.toString()===p);return e.jsxs(T,{children:[e.jsx(z,{children:e.jsx("h2",{className:"text-xl font-extrabold",children:f.Name.trim()})}),e.jsx(R,{}),e.jsxs(Y,{className:"gap-1 p-2",children:[e.jsx(K,{label:"Current Price",value:s[f.Id],isReadOnly:!0}),e.jsx(K,{label:"New Price",value:x[f.Id]||"",onChange:l=>_(f.Id,l.target.value),isRequired:!0,isInvalid:I,errorMessage:"Price not set"})]})]},f.Id)})}),d.length===0&&e.jsx("div",{className:"text-center",children:e.jsx("p",{className:"text-xl font-bold text-red-600",children:"No grades selected"})})]}),e.jsx(J,{color:"primary",fullWidth:!0,onClick:M,isLoading:n,className:"text-xl font-bold",children:"APPLY"})]})]})]}),e.jsx(R,{}),e.jsx(Re,{children:e.jsx(J,{color:"danger",onPress:u,children:"Close"})})]})})})]})}export{da as default};
