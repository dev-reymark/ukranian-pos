import{r as t,d as g,j as e,c as i,a as c,b as n}from"./app-DQR8ouMN.js";import{d as $,$ as w,a as k}from"./chunk-RUXXUVWM-CByahhe-.js";import{I as A,_ as j}from"./index-DDrqCaiR.js";import{m as H,a as R,b as T,c as L,d as V}from"./chunk-P2T5LMDM-MUOmPblZ.js";import{d}from"./chunk-44JHHBS2-BSFQFpH5.js";import{r as Y,a as M}from"./chunk-6TA6N6HF-BuxHpDGw.js";import{i as _}from"./chunk-GQQM5TNQ-BZdn_sLp.js";import{b as P}from"./chunk-DBLREEYE-CoXvdbmO.js";import"./useControlledState-DsOKAyM-.js";import"./getScrollParent-CSIo9Hxx.js";import"./FocusScope-DMt3cHMA.js";import"./useFormValidationState-BGLjVBHh.js";import"./scrollIntoView-B1mZhU84.js";import"./useFormReset-DweNStx9.js";import"./useLabels-CSRCNtbm.js";import"./NumberFormatter-DgUnyrzU.js";import"./useCollator-5Zmd5rxj.js";import"./LiveAnnouncer-C2oPZAHC.js";import"./chunk-2PIR7DFM-CbcDDgM_.js";import"./index-X92CTFGl.js";import"./VisuallyHidden-DiWMGts7.js";import"./chunk-CAFRINWI-BTDo8zfp.js";import"./useLabel-BpByWgep.js";import"./chunk-M3MASYO7-DJpgnKTJ.js";function pe({isOpen:o,onOpenChange:b}){const[u,N]=t.useState([]),[I,C]=t.useState([]),[m,S]=t.useState(null),[G,p]=t.useState(""),[l,x]=t.useState(""),[v,f]=t.useState(!1),[D,h]=t.useState(!1);t.useEffect(()=>{o&&g.get("/get-pump-nozzle").then(s=>{const a=s.data;N(a.FuelGrades||[]),C(a.Pumps||[])}).catch(s=>{console.error("Error fetching grades:",s)})},[o]);const F=s=>{const a=s.target.value,r=u.find(y=>y.Id.toString()===a);r&&(S(r),p(r.Price.toString()))},E=()=>{if(!m){console.error("No grade selected");return}if(!l){h(!0);return}f(!0);const s={Pumps:I.map(a=>({PumpId:a.PumpId,Nozzles:a.Nozzles.map(r=>({Hose_ID:r.Hose_ID,Grade_ID:r.Grade_ID,FuelGradeName:r.FuelGradeName,FuelGradePrice:r.Grade_ID===m.Id?parseFloat(l):r.FuelGradePrice,Tank_ID:r.Tank_ID}))}))};console.log("Updated Configuration:",s),g.post("/SetPumpNozzlesConfiguration",s).then(a=>{j.success("Price updated successfully!"),p(l),x("")}).catch(a=>{console.error("Error updating price:",a),j.error("Failed to update price")}).finally(()=>{f(!1),h(!1)})};return e.jsxs(e.Fragment,{children:[e.jsx(A,{position:"top-center"}),e.jsx(H,{isDismissable:!1,isKeyboardDismissDisabled:!0,size:"4xl",isOpen:o,onOpenChange:b,hideCloseButton:!0,children:e.jsx(R,{children:s=>e.jsxs(e.Fragment,{children:[e.jsx(T,{className:"flex flex-col gap-1",children:e.jsx("h1",{className:"text-2xl font-extrabold",children:"PRICE CHANGE"})}),e.jsxs(L,{className:"w-full mx-auto p-3",children:[e.jsx($,{variant:"faded",defaultValue:w(k()),label:e.jsx("p",{className:"text-lg font-extrabold",children:"EFFECTIVITY"}),labelPlacement:"outside-left",showMonthAndYearPickers:!0,isDisabled:!0}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs(i,{children:[e.jsx(c,{children:e.jsx("h2",{className:"text-xl font-extrabold",children:"Grades"})}),e.jsx(d,{}),e.jsx(n,{className:"p-4",children:e.jsx(Y,{label:"Select Grades",onChange:F,children:u.map(a=>e.jsx(M,{className:"text-xl font-semibold",size:"lg",value:a.Id.toString(),children:a.Name.trim()},a.Id))})})]}),e.jsxs("div",{className:"grid grid-rows-2 gap-2",children:[e.jsxs(i,{children:[e.jsx(c,{children:e.jsx("h2",{className:"text-xl font-extrabold",children:"Current Price"})}),e.jsx(d,{}),e.jsx(n,{className:"gap-2 p-2",children:e.jsx(_,{variant:"faded",label:"CASH",value:G,isReadOnly:!0})})]}),e.jsxs(i,{children:[e.jsx(c,{children:e.jsx("h2",{className:"text-xl font-extrabold",children:"New Price"})}),e.jsx(d,{}),e.jsx(n,{className:"gap-2 p-2",children:e.jsx(_,{label:"CASH",value:l,onChange:a=>x(a.target.value),isRequired:!0,isInvalid:D,errorMessage:"Price not set"})})]}),e.jsx(P,{color:"primary",onClick:E,isLoading:v,className:"text-xl font-bold",children:"APPLY"})]})]})]}),e.jsx(d,{}),e.jsx(V,{children:e.jsx(P,{color:"danger",onPress:s,children:"Close"})})]})})})]})}export{pe as default};
