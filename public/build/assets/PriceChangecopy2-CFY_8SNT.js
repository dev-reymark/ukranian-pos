import{r as s,a as g,j as e}from"./app-BgclCP_U.js";import{d as $,$ as w,a as k}from"./chunk-RUXXUVWM-DVz6Pog_.js";import{I as A,_ as j}from"./index-BB6kETrK.js";import{m as H,a as R,b as T,c as L,d as V}from"./chunk-P2T5LMDM-reKcKOSN.js";import{c as d}from"./chunk-H4VOEXHF-TewfOLb0.js";import{c}from"./chunk-J333S7JQ-fhG3Ko0V.js";import{d as l}from"./chunk-44JHHBS2-C3-jQeuQ.js";import{c as n}from"./chunk-5ALFRFZW-DZJt4FN_.js";import{r as Y,a as M}from"./chunk-6TA6N6HF-BpE0VHQN.js";import{i as _}from"./chunk-GQQM5TNQ-CwUyVOv_.js";import{b as P}from"./chunk-DBLREEYE-CG8yp442.js";import"./chunk-N2KXC5ZE-OZCedwgk.js";import"./chunk-XHQUSKIE-C9evg4Jy.js";import"./useControlledState-DEEM-shP.js";import"./chunk-RQNQ5XFG-CmL0HLIT.js";import"./getScrollParent-ClU_Bz4K.js";import"./FocusScope-DU-SyPrP.js";import"./useFocusable-CtZfeggp.js";import"./useFormValidationState-Ct6XxOLM.js";import"./scrollIntoView-SfQOsQd-.js";import"./useFormReset-DYDVEd1s.js";import"./useLabels-Cb_neJ1j.js";import"./useCollator-BBcv62qp.js";import"./LiveAnnouncer-D-UZuySi.js";import"./index-D3TozaOH.js";import"./chunk-2PIR7DFM-CbcDDgM_.js";import"./chunk-6NL67ZRH-DYxa27IY.js";import"./chunk-RJKRL3AU-CjtrMR1U.js";import"./index-X92CTFGl.js";import"./VisuallyHidden-DfowBU03.js";import"./chunk-CAFRINWI-BTDo8zfp.js";import"./useLabel-DpShN-Pb.js";import"./chunk-M3MASYO7-Bt50UMbM.js";function be({isOpen:i,onOpenChange:N}){const[m,b]=s.useState([]),[I,C]=s.useState([]),[u,S]=s.useState(null),[G,p]=s.useState(""),[o,f]=s.useState(""),[v,x]=s.useState(!1),[D,h]=s.useState(!1);s.useEffect(()=>{i&&g.get("/get-pump-nozzle").then(r=>{const a=r.data;b(a.FuelGrades||[]),C(a.Pumps||[])}).catch(r=>{console.error("Error fetching grades:",r)})},[i]);const F=r=>{const a=r.target.value,t=m.find(y=>y.Id.toString()===a);t&&(S(t),p(t.Price.toString()))},E=()=>{if(!u){console.error("No grade selected");return}if(!o){h(!0);return}x(!0);const r={Pumps:I.map(a=>({PumpId:a.PumpId,Nozzles:a.Nozzles.map(t=>({Hose_ID:t.Hose_ID,Grade_ID:t.Grade_ID,FuelGradeName:t.FuelGradeName,FuelGradePrice:t.Grade_ID===u.Id?parseFloat(o):t.FuelGradePrice,Tank_ID:t.Tank_ID}))}))};console.log("Updated Configuration:",r),g.post("/SetPumpNozzlesConfiguration",r).then(a=>{j.success("Price updated successfully!"),p(o),f("")}).catch(a=>{console.error("Error updating price:",a),j.error("Failed to update price")}).finally(()=>{x(!1),h(!1)})};return e.jsxs(e.Fragment,{children:[e.jsx(A,{position:"top-center"}),e.jsx(H,{isDismissable:!1,isKeyboardDismissDisabled:!0,size:"4xl",isOpen:i,onOpenChange:N,hideCloseButton:!0,children:e.jsx(R,{children:r=>e.jsxs(e.Fragment,{children:[e.jsx(T,{className:"flex flex-col gap-1",children:e.jsx("h1",{className:"text-2xl font-extrabold",children:"PRICE CHANGE"})}),e.jsxs(L,{className:"w-full mx-auto p-3",children:[e.jsx($,{variant:"faded",defaultValue:w(k()),label:e.jsx("p",{className:"text-lg font-extrabold",children:"EFFECTIVITY"}),labelPlacement:"outside-left",showMonthAndYearPickers:!0,isDisabled:!0}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs(d,{children:[e.jsx(c,{children:e.jsx("h2",{className:"text-xl font-extrabold",children:"Grades"})}),e.jsx(l,{}),e.jsx(n,{className:"p-4",children:e.jsx(Y,{label:"Select Grades",onChange:F,children:m.map(a=>e.jsx(M,{className:"text-xl font-semibold",size:"lg",value:a.Id.toString(),children:a.Name.trim()},a.Id))})})]}),e.jsxs("div",{className:"grid grid-rows-2 gap-2",children:[e.jsxs(d,{children:[e.jsx(c,{children:e.jsx("h2",{className:"text-xl font-extrabold",children:"Current Price"})}),e.jsx(l,{}),e.jsx(n,{className:"gap-2 p-2",children:e.jsx(_,{variant:"faded",label:"CASH",value:G,isReadOnly:!0})})]}),e.jsxs(d,{children:[e.jsx(c,{children:e.jsx("h2",{className:"text-xl font-extrabold",children:"New Price"})}),e.jsx(l,{}),e.jsx(n,{className:"gap-2 p-2",children:e.jsx(_,{label:"CASH",value:o,onChange:a=>f(a.target.value),isRequired:!0,isInvalid:D,errorMessage:"Price not set"})})]}),e.jsx(P,{color:"primary",onClick:E,isLoading:v,className:"text-xl font-bold",children:"APPLY"})]})]})]}),e.jsx(l,{}),e.jsx(V,{children:e.jsx(P,{color:"danger",onPress:r,children:"Close"})})]})})})]})}export{be as default};
